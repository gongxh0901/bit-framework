# bit-condition

æ¡ä»¶æ˜¾ç¤ºç³»ç»Ÿï¼Œç”¨äºå®ç° UI çº¢ç‚¹ã€è§£é”æç¤ºç­‰åŠ¨æ€æ˜¾ç¤ºåŠŸèƒ½ã€‚

## ç®€ä»‹

`bit-condition` æ˜¯åŸºäº Cocos Creator çš„æ¡ä»¶æ˜¾ç¤ºç³»ç»Ÿï¼Œæä¾›çµæ´»çš„æ¡ä»¶åˆ¤æ–­å’Œè‡ªåŠ¨æ›´æ–°æœºåˆ¶ã€‚é€‚ç”¨äºéœ€è¦æ ¹æ®æ¸¸æˆæ•°æ®åŠ¨æ€æ§åˆ¶ UI æ˜¾ç¤ºçš„åœºæ™¯ï¼Œå¦‚çº¢ç‚¹ç³»ç»Ÿã€åŠŸèƒ½è§£é”ã€ä»»åŠ¡æç¤ºç­‰ã€‚

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- ğŸ¯ æ¡ä»¶å˜åŒ–è‡ªåŠ¨é€šçŸ¥å…³è”èŠ‚ç‚¹
- ğŸ”„ æ”¯æŒ Anyï¼ˆä»»ä¸€ï¼‰å’Œ Allï¼ˆå…¨éƒ¨ï¼‰æ¡ä»¶ç»„åˆæ¨¡å¼
- ğŸ¨ è£…é¥°å™¨æ³¨å†Œæ¡ä»¶ç±»å‹
- âš¡ å®šæ—¶æ‰¹é‡æ›´æ–°ï¼Œæ€§èƒ½ä¼˜åŒ–
- ğŸ”Œ ç»§æ‰¿åŸºç±»è½»æ¾æ‰©å±•è‡ªå®šä¹‰æ¡ä»¶

## å®‰è£…

```bash
npm install @gongxh/bit-condition
```

## ä½¿ç”¨è¯´æ˜

### æ¡ä»¶æ¨¡å— (ConditionModule)

åœºæ™¯ä¸­çš„æ¡ä»¶ç³»ç»Ÿç®¡ç†ç»„ä»¶ï¼Œè´Ÿè´£å®šæ—¶æ›´æ–°æ‰€æœ‰æ¡ä»¶ã€‚

**é…ç½®å±æ€§**ï¼š
- `updateDeltaTime` - æ¡ä»¶æ›´æ–°é—´éš”ï¼ˆç§’ï¼Œé»˜è®¤ 0.3ï¼‰

**ä½¿ç”¨æ–¹å¼**ï¼š
- åœ¨åœºæ™¯æ ¹èŠ‚ç‚¹æˆ–ç®¡ç†èŠ‚ç‚¹ä¸Šæ·»åŠ  `ConditionModule` ç»„ä»¶
- ç»„ä»¶ä¼šè‡ªåŠ¨åˆå§‹åŒ–æ‰€æœ‰æ³¨å†Œçš„æ¡ä»¶

### æ¡ä»¶åŸºç±» (ConditionBase)

æ‰€æœ‰æ¡ä»¶çš„æŠ½è±¡åŸºç±»ï¼Œéœ€è¦ç»§æ‰¿å¹¶å®ç°ã€‚

**å¿…é¡»å®ç°çš„æ–¹æ³•**ï¼š
- `onInit()` - æ¡ä»¶åˆå§‹åŒ–ï¼Œæ³¨å†Œç›‘å¬ç­‰
- `evaluate()` - åˆ¤æ–­æ¡ä»¶æ˜¯å¦æ»¡è¶³ï¼Œè¿”å› boolean

**å¯è°ƒç”¨çš„æ–¹æ³•**ï¼š
- `tryUpdate()` - æ‰‹åŠ¨è§¦å‘æ¡ä»¶æ›´æ–°

**å±æ€§**ï¼š
- `type` - æ¡ä»¶ç±»å‹ï¼ˆè‡ªåŠ¨è®¾ç½®ï¼‰

### æ¡ä»¶èŠ‚ç‚¹ (ConditionNode)

UI èŠ‚ç‚¹ä¸Šçš„ç»„ä»¶ï¼Œç”¨äºå“åº”æ¡ä»¶å˜åŒ–ã€‚

**é…ç½®å±æ€§**ï¼š
- `conditionTypes` - éœ€è¦ç›‘å¬çš„æ¡ä»¶ç±»å‹åˆ—è¡¨
- `modeType` - æ¡ä»¶æ¨¡å¼ï¼ˆAny æˆ– Allï¼‰
- `onNotify` - æ¡ä»¶å˜åŒ–å›è°ƒå‡½æ•° `(canShow: boolean) => void`

**ä½¿ç”¨æ–¹å¼**ï¼š
- åœ¨éœ€è¦åŠ¨æ€æ˜¾ç¤ºçš„ UI èŠ‚ç‚¹ä¸Šæ·»åŠ  `ConditionNode` ç»„ä»¶
- é…ç½®æ¡ä»¶ç±»å‹å’Œæ¨¡å¼
- è®¾ç½®å›è°ƒå‡½æ•°å¤„ç†æ˜¾ç¤ºé€»è¾‘

### æ¡ä»¶æ¨¡å¼ (ConditionMode)

- `ConditionMode.Any` (0) - ä»»æ„ä¸€ä¸ªæ¡ä»¶æ»¡è¶³å³å¯
- `ConditionMode.All` (1) - æ‰€æœ‰æ¡ä»¶éƒ½å¿…é¡»æ»¡è¶³

### æ¡ä»¶ç®¡ç†å™¨ (ConditionManager)

å…¨å±€æ¡ä»¶ç®¡ç†ï¼Œæä¾›é™æ€æ–¹æ³•ã€‚

**ä¸»è¦æ–¹æ³•**ï¼š
- `initCondition()` - åˆå§‹åŒ–æ‰€æœ‰æ¡ä»¶ï¼ˆç”± ConditionModule è‡ªåŠ¨è°ƒç”¨ï¼‰
- `_addUpdateCondition(conditionType)` - æ‰‹åŠ¨æ ‡è®°æ¡ä»¶éœ€è¦æ›´æ–°
- `_nowUpdateConditionNode(node)` - ç«‹å³æ›´æ–°æŒ‡å®šèŠ‚ç‚¹

### è£…é¥°å™¨

ä½¿ç”¨ `@condition(conditionType)` è£…é¥°å™¨æ³¨å†Œæ¡ä»¶ç±»ï¼š

```typescript
import { condition, ConditionBase } from '@gongxh/bit-condition';

@condition(ConditionType.NewMail)
export class NewMailCondition extends ConditionBase {
    protected onInit(): void {
        // åˆå§‹åŒ–é€»è¾‘
    }
    
    protected evaluate(): boolean {
        // æ¡ä»¶åˆ¤æ–­é€»è¾‘
        return MailSystem.hasUnreadMail();
    }
}
```

### å…¸å‹ä½¿ç”¨æµç¨‹

1. **æ·»åŠ æ¨¡å—** - åœ¨åœºæ™¯ä¸­æ·»åŠ  `ConditionModule` ç»„ä»¶
2. **å®šä¹‰æ¡ä»¶ç±»å‹** - ä½¿ç”¨æšä¸¾å®šä¹‰æ¡ä»¶ç±»å‹
3. **å®ç°æ¡ä»¶ç±»** - ç»§æ‰¿ `ConditionBase` å¹¶ä½¿ç”¨è£…é¥°å™¨æ³¨å†Œ
4. **æ·»åŠ æ¡ä»¶èŠ‚ç‚¹** - åœ¨ UI èŠ‚ç‚¹ä¸Šæ·»åŠ  `ConditionNode` ç»„ä»¶
5. **è§¦å‘æ›´æ–°** - æ•°æ®å˜åŒ–æ—¶è°ƒç”¨ `ConditionManager._addUpdateCondition()`

è¯¦ç»† API è¯·æŸ¥çœ‹ `bit-condition.d.ts` ç±»å‹å®šä¹‰æ–‡ä»¶ã€‚

## ä¾èµ–

- [@gongxh/bit-core](https://www.npmjs.com/package/@gongxh/bit-core) - æ ¸å¿ƒåŠŸèƒ½

## è®¸å¯è¯

MIT License

## ä½œè€…

**bitè€å®«** (gongxh)  
**é‚®ç®±**: gong.xinhai@163.com

## æºç ä»“åº“

- [GitHub](https://github.com/Gongxh0901/bit-framework)
- [npm](https://www.npmjs.com/package/@gongxh/bit-condition)
